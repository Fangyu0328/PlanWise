{"ast":null,"code":"import axios from 'axios';\nconst API_URL = 'http://localhost:4000/api';\nconst OPENAI_API_KEY = process.env.REACT_APP_OPENAI_API_KEY || 'your-api-key-here';\nconst API_ENDPOINT = 'https://api.openai.com/v1/chat/completions';\n\n/**\n * Parse natural language input to calendar events with OpenAI\n * @param {string} text - Natural language description of event\n * @returns {Promise<Object>} - Parsed event data\n */\nexport const parseEventText = async text => {\n  try {\n    // Use OpenAI to process the event text\n    const response = await axios.post(API_ENDPOINT, {\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are a calendar event assistant. Extract event information from user input and create a simplified title.\n            \n            Examples:\n            - Input: \"I will have dinner with John tomorrow night at 7pm\"\n              Output: Title should be \"Dinner with John\", date is tomorrow, time is 7pm\n            - Input: \"Cancel my meeting with marketing team\"\n              Output: Action should be cancel, event to cancel is \"meeting with marketing team\"\n            \n            Format your response as a JSON object with these fields:\n            - action: 'add' or 'cancel'\n            - title: Simplified event title (remove date/time info, focus on the core event)\n            - start: Event start time (ISO format)\n            - end: Event end time (ISO format)\n            - location: Optional location (if mentioned)\n            - notes: Optional notes (if any additional information is provided)`\n      }, {\n        role: \"user\",\n        content: text\n      }],\n      temperature: 0.3,\n      max_tokens: 250\n    }, {\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      }\n    });\n\n    // Parse the OpenAI response\n    const result = JSON.parse(response.data.choices[0].message.content);\n\n    // Convert string dates to Date objects\n    return {\n      ...result,\n      start: new Date(result.start),\n      end: new Date(result.end)\n    };\n  } catch (error) {\n    console.error('Error processing event with OpenAI:', error);\n    // Fallback to API or simple parsing if OpenAI call fails\n    try {\n      const response = await axios.post(`${API_URL}/parse-event`, {\n        text\n      });\n      const result = response.data;\n      return {\n        ...result,\n        start: new Date(result.start),\n        end: new Date(result.end)\n      };\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackParsing(text);\n    }\n  }\n};\n\n/**\n * Generate optimized task schedule based on priorities, deadlines, and existing calendar events\n * @param {Array} tasks - List of tasks with priorities and deadlines\n * @param {Array} events - Existing calendar events\n * @param {Object} preferences - User preferences for scheduling\n * @returns {Promise<Array>} - Optimized schedule of tasks\n */\nexport const optimizeTaskSchedule = async (tasks, events, preferences) => {\n  try {\n    // Prepare task and event data for OpenAI\n    const tasksData = tasks.map(task => ({\n      id: task.id,\n      title: task.title,\n      priority: task.priority,\n      duration: parseFloat(task.duration),\n      // Ensure it's a number\n      deadline: task.deadline,\n      // In ISO format with specific time\n      category: task.category ? task.category.id || task.category : 'work'\n    }));\n    const eventsData = events.map(event => ({\n      title: event.title,\n      start: typeof event.start === 'string' ? event.start : event.start.toISOString(),\n      end: typeof event.end === 'string' ? event.end : event.end.toISOString()\n    }));\n\n    // Ensure preferences are properly formatted\n    const formattedPreferences = {\n      workingHours: {\n        start: preferences.workingHours.start || '09:00',\n        end: preferences.workingHours.end || '17:00'\n      },\n      maxTasksPerDay: preferences.maxTasksPerDay || 5,\n      breakBetweenTasks: preferences.breakBetweenTasks || 15,\n      // minutes\n      splitTaskThreshold: preferences.splitTaskThreshold || 2 // hours\n    };\n    const response = await axios.post(API_ENDPOINT, {\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are a task scheduling assistant. Optimize the user's tasks based on priorities, deadlines, and existing calendar events.\n            \n            Important scheduling rules:\n            1. Tasks must NEVER overlap with each other or with existing calendar events\n            2. Higher priority tasks should be scheduled earlier, especially those with imminent deadlines\n            3. If a task is longer than ${formattedPreferences.splitTaskThreshold} hours, break it into multiple smaller sessions across different time slots or days\n            4. Schedule ONLY ONE task per time slot - absolutely no overlapping tasks\n            5. Honor the user's working hours preference (${formattedPreferences.workingHours.start} to ${formattedPreferences.workingHours.end})\n            6. Include ${formattedPreferences.breakBetweenTasks}-minute breaks between tasks\n            7. Limit to ${formattedPreferences.maxTasksPerDay} tasks per day\n            8. Put highest priority on meeting the deadline for each task\n            \n            Format your response as a JSON array of scheduled tasks, with each task having:\n            - id: The original task ID\n            - title: Task title\n            - start: Start time (ISO format)\n            - end: End time (ISO format)\n            - category: Task category (use the original task's category)\n            - notes: Optional scheduling notes (e.g., \"Part 1 of 3\" for split tasks)\n            \n            Each task must have a specific time slot with no overlaps.`\n      }, {\n        role: \"user\",\n        content: JSON.stringify({\n          tasks: tasksData,\n          events: eventsData,\n          preferences: formattedPreferences\n        })\n      }],\n      temperature: 0.2,\n      // Lower temperature for more deterministic results\n      max_tokens: 1500\n    }, {\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      }\n    });\n\n    // Parse and process the OpenAI response\n    const result = JSON.parse(response.data.choices[0].message.content);\n\n    // Convert string dates to Date objects and ensure proper formatting\n    return result.map(task => {\n      var _tasks$find;\n      return {\n        ...task,\n        start: new Date(task.start),\n        end: new Date(task.end),\n        category: ((_tasks$find = tasks.find(t => t.id === task.id)) === null || _tasks$find === void 0 ? void 0 : _tasks$find.category) || {\n          id: task.category,\n          name: task.category\n        }\n      };\n    });\n  } catch (error) {\n    console.error('Error optimizing task schedule with OpenAI:', error);\n\n    // Try the backend API\n    try {\n      const response = await axios.post(`${API_URL}/schedule-tasks`, {\n        tasks,\n        events,\n        preferences\n      });\n\n      // Convert string dates to Date objects in the schedule\n      return response.data.schedule.map(task => ({\n        ...task,\n        start: new Date(task.start),\n        end: new Date(task.end)\n      }));\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      throw new Error('Failed to generate schedule with both OpenAI and backend API');\n    }\n  }\n};\n\n/**\n * Find best meeting times based on participants' availability\n * @param {Array} participantAvailability - Availability data from all participants\n * @param {Object} meetingParams - Meeting parameters (duration, preferred days, etc.)\n * @returns {Promise<Array>} - Best meeting time slots\n */\nexport const findBestMeetingSlots = async (participantAvailability, meetingParams) => {\n  try {\n    const response = await axios.post(API_ENDPOINT, {\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are a meeting scheduling assistant. Find the best meeting times based on all participants' availability.\n            \n            Important considerations:\n            1. Prioritize slots where all participants are available\n            2. If no slot has 100% availability, find slots with maximum participation\n            3. Respect preferred days specified in the meeting parameters\n            4. Ensure the slot duration accommodates the required meeting length\n            5. Stay within the specified time range\n            \n            Format your response as a JSON array of available slots, each containing:\n            - day: Day of the week (e.g., 'monday')\n            - date: Formatted date (e.g., 'May 1')\n            - time: Time range (e.g., '10:00 AM - 11:00 AM')\n            - availability: 'all' or 'partial'\n            - availableCount: Number of available participants (if partial)\n            - totalCount: Total number of participants\n            \n            Sort the slots by best fit (all available first, then by number of available participants).`\n      }, {\n        role: \"user\",\n        content: JSON.stringify({\n          participantAvailability: participantAvailability,\n          meetingParams: meetingParams\n        })\n      }],\n      temperature: 0.3,\n      max_tokens: 500\n    }, {\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      }\n    });\n    return JSON.parse(response.data.choices[0].message.content);\n  } catch (error) {\n    console.error('Error finding best meeting slots with OpenAI:', error);\n\n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/find-meeting-slots`, {\n        participantAvailability,\n        meetingParams\n      });\n      return response.data.slots;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackMeetingSlots(participantAvailability, meetingParams);\n    }\n  }\n};\n\n/**\n * Generate personalized habit recommendations based on mood and activity history\n * @param {Array} moodEntries - History of mood entries\n * @param {Array} activityEntries - History of activities\n * @returns {Promise<Array>} - Personalized recommendations\n */\nexport const generateRecommendations = async (moodEntries, activityEntries) => {\n  try {\n    const response = await axios.post(API_ENDPOINT, {\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are a personalized habit recommendation assistant. Analyze the user's mood patterns and activities to suggest an ideal daily schedule.\n            \n            Consider:\n            1. Time-specific mood patterns (morning, afternoon, evening)\n            2. Activities that correlate with positive moods\n            3. Balance across different activity categories\n            4. Sustainable habit formation principles\n            \n            Format your response as a JSON array of recommendation blocks, each with:\n            - id: Unique identifier for the recommendation\n            - title: Section title (e.g., 'Morning Routine', 'Productivity Boost')\n            - activities: Array of suggested activities with:\n              - time: Suggested time (e.g., '07:00 AM')\n              - description: Activity description\n              - category: Category ID (e.g., 'selfCare', 'work', 'exercise')\n              \n            The recommendations should be detailed yet realistic for daily implementation.`\n      }, {\n        role: \"user\",\n        content: JSON.stringify({\n          moodEntries: moodEntries,\n          activityEntries: activityEntries\n        })\n      }],\n      temperature: 0.5,\n      max_tokens: 1000\n    }, {\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      }\n    });\n    return JSON.parse(response.data.choices[0].message.content);\n  } catch (error) {\n    console.error('Error generating recommendations with OpenAI:', error);\n\n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/generate-recommendations`, {\n        moodEntries,\n        activityEntries\n      });\n      return response.data.recommendations;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackRecommendations(moodEntries, activityEntries);\n    }\n  }\n};\n\n/**\n * Analyze evening reflection and provide feedback\n * @param {string} reflectionText - User's evening reflection\n * @param {Array} moodEntries - Recent mood entries\n * @param {Array} activityEntries - Recent activity entries\n * @returns {Promise<string>} - Personalized feedback\n */\nexport const analyzeReflection = async (reflectionText, moodEntries, activityEntries) => {\n  try {\n    const response = await axios.post(API_ENDPOINT, {\n      model: \"gpt-4\",\n      messages: [{\n        role: \"system\",\n        content: `You are a reflection analysis assistant. Provide insightful feedback on the user's evening reflection, considering their mood and activity patterns.\n            \n            Your feedback should:\n            1. Acknowledge positive behaviors and attitudes\n            2. Identify potential improvement areas tactfully\n            3. Offer specific suggestions aligned with their goals\n            4. Recommend potential habit adjustments based on patterns\n            5. Maintain a warm, encouraging tone\n            \n            Format your response as a thoughtful paragraph of feedback, keeping it concise yet meaningful.`\n      }, {\n        role: \"user\",\n        content: JSON.stringify({\n          reflection: reflectionText,\n          recentMoods: moodEntries.slice(0, 5),\n          recentActivities: activityEntries.slice(0, 10)\n        })\n      }],\n      temperature: 0.7,\n      max_tokens: 500\n    }, {\n      headers: {\n        'Authorization': `Bearer ${OPENAI_API_KEY}`,\n        'Content-Type': 'application/json'\n      }\n    });\n    return response.data.choices[0].message.content;\n  } catch (error) {\n    console.error('Error analyzing reflection with OpenAI:', error);\n\n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/analyze-reflection`, {\n        reflectionText,\n        moodEntries,\n        activityEntries\n      });\n      return response.data.feedback;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackReflectionAnalysis(reflectionText);\n    }\n  }\n};\n\n// Fallback functions for when API calls fail\nconst fallbackParsing = text => {\n  // Simple parsing logic similar to what we had before\n  const lowerText = text.toLowerCase();\n  let title = text;\n  let start = new Date();\n  let end = new Date();\n\n  // Check if this is a cancellation request\n  if (lowerText.includes('cancel') || lowerText.includes('delete') || lowerText.includes('remove')) {\n    const eventToCancel = text.replace(/cancel|delete|remove/i, '').trim();\n    return {\n      action: 'cancel',\n      eventToCancel\n    };\n  }\n\n  // Very basic parsing logic for date\n  if (lowerText.includes('tomorrow')) {\n    start.setDate(start.getDate() + 1);\n    end.setDate(end.getDate() + 1);\n  } else if (lowerText.includes('next week')) {\n    start.setDate(start.getDate() + 7);\n    end.setDate(end.getDate() + 7);\n  }\n\n  // Very basic parsing logic for time\n  if (lowerText.includes('at')) {\n    const timeMatch = lowerText.match(/at\\s+(\\d{1,2})(?::(\\d{2}))?\\s*(am|pm)?/i);\n    if (timeMatch) {\n      let hours = parseInt(timeMatch[1], 10);\n      const minutes = timeMatch[2] ? parseInt(timeMatch[2], 10) : 0;\n      const ampm = timeMatch[3] ? timeMatch[3].toLowerCase() : null;\n      if (ampm === 'pm' && hours < 12) hours += 12;\n      if (ampm === 'am' && hours === 12) hours = 0;\n      start.setHours(hours, minutes, 0, 0);\n      end = new Date(start.getTime() + 60 * 60 * 1000); // Default 1 hour\n    }\n  }\n\n  // Basic title simplification\n  if (lowerText.includes('meeting')) {\n    title = 'Meeting';\n  } else if (lowerText.includes('lunch')) {\n    title = 'Lunch';\n  } else if (lowerText.includes('dinner')) {\n    title = 'Dinner';\n  } else if (lowerText.includes('coffee')) {\n    title = 'Coffee';\n  }\n\n  // Add with whom\n  const withMatch = lowerText.match(/with\\s+([a-z\\s]+)(?:at|tomorrow|next|on|$)/i);\n  if (withMatch) {\n    const withWhom = withMatch[1].trim();\n    title = `${title} with ${withWhom}`;\n  }\n  return {\n    action: 'add',\n    title,\n    start,\n    end,\n    notes: '',\n    location: ''\n  };\n};\nconst fallbackScheduling = tasks => {\n  // Sort by priority and deadline\n  return [...tasks].sort((a, b) => {\n    // First by priority (high to low)\n    if (b.priority !== a.priority) {\n      return b.priority - a.priority;\n    }\n    // Then by deadline (earlier first)\n    return new Date(a.deadline) - new Date(b.deadline);\n  }).map((task, index) => {\n    // Create scheduled events\n    const start = new Date();\n    start.setHours(9 + index, 0, 0, 0); // Start at 9 AM, each task 1 hour later\n\n    const duration = parseFloat(task.duration) || 1; // Default to 1 hour\n    const end = new Date(start.getTime() + duration * 60 * 60 * 1000);\n    return {\n      id: task.id,\n      title: task.title,\n      start: start,\n      end: end,\n      category: task.category || 'work'\n    };\n  });\n};\nconst fallbackMeetingSlots = (participantAvailability, meetingParams) => {\n  // Generate three dummy time slots\n  const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\n\n  // Get preferred days or default to all weekdays\n  const preferredDays = meetingParams.preferredDays && meetingParams.preferredDays.length > 0 ? meetingParams.preferredDays : days;\n\n  // Create dummy slots\n  return [{\n    day: preferredDays[0] || 'monday',\n    date: 'May 1',\n    time: '10:00 AM - 11:00 AM',\n    availability: 'all'\n  }, {\n    day: preferredDays[preferredDays.length > 1 ? 1 : 0] || 'wednesday',\n    date: 'May 3',\n    time: '2:00 PM - 3:00 PM',\n    availability: 'all'\n  }, {\n    day: preferredDays[0] || 'monday',\n    date: 'May 8',\n    time: '11:00 AM - 12:00 PM',\n    availability: 'partial',\n    availableCount: 2,\n    totalCount: 3\n  }];\n};\nconst fallbackRecommendations = (moodEntries, activityEntries) => {\n  // Simple recommendations\n  return [{\n    id: 'morning',\n    title: 'Morning Routine',\n    activities: [{\n      time: '07:00 AM',\n      description: 'Wake up & hydrate',\n      category: 'selfCare'\n    }, {\n      time: '07:15 AM',\n      description: 'Quick stretch or meditation',\n      category: 'selfCare'\n    }, {\n      time: '07:45 AM',\n      description: 'Healthy breakfast',\n      category: 'selfCare'\n    }, {\n      time: '08:15 AM',\n      description: 'Plan your day',\n      category: 'work'\n    }]\n  }, {\n    id: 'balance',\n    title: 'Balance Your Day',\n    activities: [{\n      time: '11:30 AM',\n      description: 'Take a short break',\n      category: 'selfCare'\n    }, {\n      time: '05:00 PM',\n      description: 'Transition from work to personal time',\n      category: 'selfCare'\n    }, {\n      time: '07:00 PM',\n      description: 'Dinner & relaxation',\n      category: 'leisure'\n    }, {\n      time: '10:00 PM',\n      description: 'Wind down routine',\n      category: 'sleep'\n    }]\n  }];\n};\nconst fallbackReflectionAnalysis = reflectionText => {\n  return \"Thank you for sharing your reflection. It's great that you're taking time to review your day. Consider how your activities might be affecting your mood, and remember that small adjustments can lead to significant improvements in your well-being. Keep up the good work with your self-reflection practice!\";\n};\n\n// Create a named export object\nconst openAIService = {\n  parseEventText,\n  optimizeTaskSchedule,\n  findBestMeetingSlots,\n  generateRecommendations,\n  analyzeReflection\n};\nexport default openAIService;","map":{"version":3,"names":["axios","API_URL","OPENAI_API_KEY","process","env","REACT_APP_OPENAI_API_KEY","API_ENDPOINT","parseEventText","text","response","post","model","messages","role","content","temperature","max_tokens","headers","result","JSON","parse","data","choices","message","start","Date","end","error","console","backendError","fallbackParsing","optimizeTaskSchedule","tasks","events","preferences","tasksData","map","task","id","title","priority","duration","parseFloat","deadline","category","eventsData","event","toISOString","formattedPreferences","workingHours","maxTasksPerDay","breakBetweenTasks","splitTaskThreshold","stringify","_tasks$find","find","t","name","schedule","Error","findBestMeetingSlots","participantAvailability","meetingParams","slots","fallbackMeetingSlots","generateRecommendations","moodEntries","activityEntries","recommendations","fallbackRecommendations","analyzeReflection","reflectionText","reflection","recentMoods","slice","recentActivities","feedback","fallbackReflectionAnalysis","lowerText","toLowerCase","includes","eventToCancel","replace","trim","action","setDate","getDate","timeMatch","match","hours","parseInt","minutes","ampm","setHours","getTime","withMatch","withWhom","notes","location","fallbackScheduling","sort","a","b","index","days","preferredDays","length","day","date","time","availability","availableCount","totalCount","activities","description","openAIService"],"sources":["/Users/wenxinmiao/Desktop/PlanWise/client/src/Services/openAIservice.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_URL = 'http://localhost:4000/api';\nconst OPENAI_API_KEY = process.env.REACT_APP_OPENAI_API_KEY || 'your-api-key-here';\nconst API_ENDPOINT = 'https://api.openai.com/v1/chat/completions';\n\n/**\n * Parse natural language input to calendar events with OpenAI\n * @param {string} text - Natural language description of event\n * @returns {Promise<Object>} - Parsed event data\n */\nexport const parseEventText = async (text) => {\n  try {\n    // Use OpenAI to process the event text\n    const response = await axios.post(\n      API_ENDPOINT,\n      {\n        model: \"gpt-4\",\n        messages: [\n          {\n            role: \"system\",\n            content: `You are a calendar event assistant. Extract event information from user input and create a simplified title.\n            \n            Examples:\n            - Input: \"I will have dinner with John tomorrow night at 7pm\"\n              Output: Title should be \"Dinner with John\", date is tomorrow, time is 7pm\n            - Input: \"Cancel my meeting with marketing team\"\n              Output: Action should be cancel, event to cancel is \"meeting with marketing team\"\n            \n            Format your response as a JSON object with these fields:\n            - action: 'add' or 'cancel'\n            - title: Simplified event title (remove date/time info, focus on the core event)\n            - start: Event start time (ISO format)\n            - end: Event end time (ISO format)\n            - location: Optional location (if mentioned)\n            - notes: Optional notes (if any additional information is provided)`\n          },\n          {\n            role: \"user\",\n            content: text\n          }\n        ],\n        temperature: 0.3,\n        max_tokens: 250\n      },\n      {\n        headers: {\n          'Authorization': `Bearer ${OPENAI_API_KEY}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    );\n\n    // Parse the OpenAI response\n    const result = JSON.parse(response.data.choices[0].message.content);\n    \n    // Convert string dates to Date objects\n    return {\n      ...result,\n      start: new Date(result.start),\n      end: new Date(result.end)\n    };\n  } catch (error) {\n    console.error('Error processing event with OpenAI:', error);\n    // Fallback to API or simple parsing if OpenAI call fails\n    try {\n      const response = await axios.post(`${API_URL}/parse-event`, { text });\n      const result = response.data;\n      \n      return {\n        ...result,\n        start: new Date(result.start),\n        end: new Date(result.end)\n      };\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackParsing(text);\n    }\n  }\n};\n\n/**\n * Generate optimized task schedule based on priorities, deadlines, and existing calendar events\n * @param {Array} tasks - List of tasks with priorities and deadlines\n * @param {Array} events - Existing calendar events\n * @param {Object} preferences - User preferences for scheduling\n * @returns {Promise<Array>} - Optimized schedule of tasks\n */\nexport const optimizeTaskSchedule = async (tasks, events, preferences) => {\n  try {\n    // Prepare task and event data for OpenAI\n    const tasksData = tasks.map(task => ({\n      id: task.id,\n      title: task.title,\n      priority: task.priority,\n      duration: parseFloat(task.duration), // Ensure it's a number\n      deadline: task.deadline, // In ISO format with specific time\n      category: task.category ? task.category.id || task.category : 'work'\n    }));\n    \n    const eventsData = events.map(event => ({\n      title: event.title,\n      start: typeof event.start === 'string' ? event.start : event.start.toISOString(),\n      end: typeof event.end === 'string' ? event.end : event.end.toISOString()\n    }));\n    \n    // Ensure preferences are properly formatted\n    const formattedPreferences = {\n      workingHours: {\n        start: preferences.workingHours.start || '09:00',\n        end: preferences.workingHours.end || '17:00'\n      },\n      maxTasksPerDay: preferences.maxTasksPerDay || 5,\n      breakBetweenTasks: preferences.breakBetweenTasks || 15, // minutes\n      splitTaskThreshold: preferences.splitTaskThreshold || 2 // hours\n    };\n    \n    const response = await axios.post(\n      API_ENDPOINT,\n      {\n        model: \"gpt-4\",\n        messages: [\n          {\n            role: \"system\",\n            content: `You are a task scheduling assistant. Optimize the user's tasks based on priorities, deadlines, and existing calendar events.\n            \n            Important scheduling rules:\n            1. Tasks must NEVER overlap with each other or with existing calendar events\n            2. Higher priority tasks should be scheduled earlier, especially those with imminent deadlines\n            3. If a task is longer than ${formattedPreferences.splitTaskThreshold} hours, break it into multiple smaller sessions across different time slots or days\n            4. Schedule ONLY ONE task per time slot - absolutely no overlapping tasks\n            5. Honor the user's working hours preference (${formattedPreferences.workingHours.start} to ${formattedPreferences.workingHours.end})\n            6. Include ${formattedPreferences.breakBetweenTasks}-minute breaks between tasks\n            7. Limit to ${formattedPreferences.maxTasksPerDay} tasks per day\n            8. Put highest priority on meeting the deadline for each task\n            \n            Format your response as a JSON array of scheduled tasks, with each task having:\n            - id: The original task ID\n            - title: Task title\n            - start: Start time (ISO format)\n            - end: End time (ISO format)\n            - category: Task category (use the original task's category)\n            - notes: Optional scheduling notes (e.g., \"Part 1 of 3\" for split tasks)\n            \n            Each task must have a specific time slot with no overlaps.`\n          },\n          {\n            role: \"user\",\n            content: JSON.stringify({\n              tasks: tasksData,\n              events: eventsData,\n              preferences: formattedPreferences\n            })\n          }\n        ],\n        temperature: 0.2, // Lower temperature for more deterministic results\n        max_tokens: 1500\n      },\n      {\n        headers: {\n          'Authorization': `Bearer ${OPENAI_API_KEY}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    );\n\n    // Parse and process the OpenAI response\n    const result = JSON.parse(response.data.choices[0].message.content);\n    \n    // Convert string dates to Date objects and ensure proper formatting\n    return result.map(task => ({\n      ...task,\n      start: new Date(task.start),\n      end: new Date(task.end),\n      category: tasks.find(t => t.id === task.id)?.category || { id: task.category, name: task.category }\n    }));\n  } catch (error) {\n    console.error('Error optimizing task schedule with OpenAI:', error);\n    \n    // Try the backend API\n    try {\n      const response = await axios.post(`${API_URL}/schedule-tasks`, { \n        tasks, \n        events, \n        preferences \n      });\n      \n      // Convert string dates to Date objects in the schedule\n      return response.data.schedule.map(task => ({\n        ...task,\n        start: new Date(task.start),\n        end: new Date(task.end)\n      }));\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      throw new Error('Failed to generate schedule with both OpenAI and backend API');\n    }\n  }\n};\n\n/**\n * Find best meeting times based on participants' availability\n * @param {Array} participantAvailability - Availability data from all participants\n * @param {Object} meetingParams - Meeting parameters (duration, preferred days, etc.)\n * @returns {Promise<Array>} - Best meeting time slots\n */\nexport const findBestMeetingSlots = async (participantAvailability, meetingParams) => {\n  try {\n    const response = await axios.post(\n      API_ENDPOINT,\n      {\n        model: \"gpt-4\",\n        messages: [\n          {\n            role: \"system\",\n            content: `You are a meeting scheduling assistant. Find the best meeting times based on all participants' availability.\n            \n            Important considerations:\n            1. Prioritize slots where all participants are available\n            2. If no slot has 100% availability, find slots with maximum participation\n            3. Respect preferred days specified in the meeting parameters\n            4. Ensure the slot duration accommodates the required meeting length\n            5. Stay within the specified time range\n            \n            Format your response as a JSON array of available slots, each containing:\n            - day: Day of the week (e.g., 'monday')\n            - date: Formatted date (e.g., 'May 1')\n            - time: Time range (e.g., '10:00 AM - 11:00 AM')\n            - availability: 'all' or 'partial'\n            - availableCount: Number of available participants (if partial)\n            - totalCount: Total number of participants\n            \n            Sort the slots by best fit (all available first, then by number of available participants).`\n          },\n          {\n            role: \"user\",\n            content: JSON.stringify({\n              participantAvailability: participantAvailability,\n              meetingParams: meetingParams\n            })\n          }\n        ],\n        temperature: 0.3,\n        max_tokens: 500\n      },\n      {\n        headers: {\n          'Authorization': `Bearer ${OPENAI_API_KEY}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    );\n\n    return JSON.parse(response.data.choices[0].message.content);\n  } catch (error) {\n    console.error('Error finding best meeting slots with OpenAI:', error);\n    \n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/find-meeting-slots`, {\n        participantAvailability,\n        meetingParams\n      });\n      \n      return response.data.slots;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackMeetingSlots(participantAvailability, meetingParams);\n    }\n  }\n};\n\n/**\n * Generate personalized habit recommendations based on mood and activity history\n * @param {Array} moodEntries - History of mood entries\n * @param {Array} activityEntries - History of activities\n * @returns {Promise<Array>} - Personalized recommendations\n */\nexport const generateRecommendations = async (moodEntries, activityEntries) => {\n  try {\n    const response = await axios.post(\n      API_ENDPOINT,\n      {\n        model: \"gpt-4\",\n        messages: [\n          {\n            role: \"system\",\n            content: `You are a personalized habit recommendation assistant. Analyze the user's mood patterns and activities to suggest an ideal daily schedule.\n            \n            Consider:\n            1. Time-specific mood patterns (morning, afternoon, evening)\n            2. Activities that correlate with positive moods\n            3. Balance across different activity categories\n            4. Sustainable habit formation principles\n            \n            Format your response as a JSON array of recommendation blocks, each with:\n            - id: Unique identifier for the recommendation\n            - title: Section title (e.g., 'Morning Routine', 'Productivity Boost')\n            - activities: Array of suggested activities with:\n              - time: Suggested time (e.g., '07:00 AM')\n              - description: Activity description\n              - category: Category ID (e.g., 'selfCare', 'work', 'exercise')\n              \n            The recommendations should be detailed yet realistic for daily implementation.`\n          },\n          {\n            role: \"user\",\n            content: JSON.stringify({\n              moodEntries: moodEntries,\n              activityEntries: activityEntries\n            })\n          }\n        ],\n        temperature: 0.5,\n        max_tokens: 1000\n      },\n      {\n        headers: {\n          'Authorization': `Bearer ${OPENAI_API_KEY}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    );\n\n    return JSON.parse(response.data.choices[0].message.content);\n  } catch (error) {\n    console.error('Error generating recommendations with OpenAI:', error);\n    \n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/generate-recommendations`, {\n        moodEntries,\n        activityEntries\n      });\n      \n      return response.data.recommendations;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackRecommendations(moodEntries, activityEntries);\n    }\n  }\n};\n\n/**\n * Analyze evening reflection and provide feedback\n * @param {string} reflectionText - User's evening reflection\n * @param {Array} moodEntries - Recent mood entries\n * @param {Array} activityEntries - Recent activity entries\n * @returns {Promise<string>} - Personalized feedback\n */\nexport const analyzeReflection = async (reflectionText, moodEntries, activityEntries) => {\n  try {\n    const response = await axios.post(\n      API_ENDPOINT,\n      {\n        model: \"gpt-4\",\n        messages: [\n          {\n            role: \"system\",\n            content: `You are a reflection analysis assistant. Provide insightful feedback on the user's evening reflection, considering their mood and activity patterns.\n            \n            Your feedback should:\n            1. Acknowledge positive behaviors and attitudes\n            2. Identify potential improvement areas tactfully\n            3. Offer specific suggestions aligned with their goals\n            4. Recommend potential habit adjustments based on patterns\n            5. Maintain a warm, encouraging tone\n            \n            Format your response as a thoughtful paragraph of feedback, keeping it concise yet meaningful.`\n          },\n          {\n            role: \"user\",\n            content: JSON.stringify({\n              reflection: reflectionText,\n              recentMoods: moodEntries.slice(0, 5),\n              recentActivities: activityEntries.slice(0, 10)\n            })\n          }\n        ],\n        temperature: 0.7,\n        max_tokens: 500\n      },\n      {\n        headers: {\n          'Authorization': `Bearer ${OPENAI_API_KEY}`,\n          'Content-Type': 'application/json'\n        }\n      }\n    );\n\n    return response.data.choices[0].message.content;\n  } catch (error) {\n    console.error('Error analyzing reflection with OpenAI:', error);\n    \n    // Try backend API\n    try {\n      const response = await axios.post(`${API_URL}/analyze-reflection`, {\n        reflectionText,\n        moodEntries,\n        activityEntries\n      });\n      \n      return response.data.feedback;\n    } catch (backendError) {\n      console.error('Backend API also failed:', backendError);\n      return fallbackReflectionAnalysis(reflectionText);\n    }\n  }\n};\n\n// Fallback functions for when API calls fail\nconst fallbackParsing = (text) => {\n  // Simple parsing logic similar to what we had before\n  const lowerText = text.toLowerCase();\n  let title = text;\n  let start = new Date();\n  let end = new Date();\n  \n  // Check if this is a cancellation request\n  if (lowerText.includes('cancel') || lowerText.includes('delete') || lowerText.includes('remove')) {\n    const eventToCancel = text.replace(/cancel|delete|remove/i, '').trim();\n    return { action: 'cancel', eventToCancel };\n  }\n  \n  // Very basic parsing logic for date\n  if (lowerText.includes('tomorrow')) {\n    start.setDate(start.getDate() + 1);\n    end.setDate(end.getDate() + 1);\n  } else if (lowerText.includes('next week')) {\n    start.setDate(start.getDate() + 7);\n    end.setDate(end.getDate() + 7);\n  }\n  \n  // Very basic parsing logic for time\n  if (lowerText.includes('at')) {\n    const timeMatch = lowerText.match(/at\\s+(\\d{1,2})(?::(\\d{2}))?\\s*(am|pm)?/i);\n    if (timeMatch) {\n      let hours = parseInt(timeMatch[1], 10);\n      const minutes = timeMatch[2] ? parseInt(timeMatch[2], 10) : 0;\n      const ampm = timeMatch[3] ? timeMatch[3].toLowerCase() : null;\n      \n      if (ampm === 'pm' && hours < 12) hours += 12;\n      if (ampm === 'am' && hours === 12) hours = 0;\n      \n      start.setHours(hours, minutes, 0, 0);\n      end = new Date(start.getTime() + 60 * 60 * 1000); // Default 1 hour\n    }\n  }\n  \n  // Basic title simplification\n  if (lowerText.includes('meeting')) {\n    title = 'Meeting';\n  } else if (lowerText.includes('lunch')) {\n    title = 'Lunch';\n  } else if (lowerText.includes('dinner')) {\n    title = 'Dinner';\n  } else if (lowerText.includes('coffee')) {\n    title = 'Coffee';\n  }\n  \n  // Add with whom\n  const withMatch = lowerText.match(/with\\s+([a-z\\s]+)(?:at|tomorrow|next|on|$)/i);\n  if (withMatch) {\n    const withWhom = withMatch[1].trim();\n    title = `${title} with ${withWhom}`;\n  }\n  \n  return { action: 'add', title, start, end, notes: '', location: '' };\n};\n\nconst fallbackScheduling = (tasks) => {\n  // Sort by priority and deadline\n  return [...tasks].sort((a, b) => {\n    // First by priority (high to low)\n    if (b.priority !== a.priority) {\n      return b.priority - a.priority;\n    }\n    // Then by deadline (earlier first)\n    return new Date(a.deadline) - new Date(b.deadline);\n  }).map((task, index) => {\n    // Create scheduled events\n    const start = new Date();\n    start.setHours(9 + index, 0, 0, 0); // Start at 9 AM, each task 1 hour later\n    \n    const duration = parseFloat(task.duration) || 1; // Default to 1 hour\n    const end = new Date(start.getTime() + duration * 60 * 60 * 1000);\n    \n    return {\n      id: task.id,\n      title: task.title,\n      start: start,\n      end: end,\n      category: task.category || 'work'\n    };\n  });\n};\n\nconst fallbackMeetingSlots = (participantAvailability, meetingParams) => {\n  // Generate three dummy time slots\n  const days = ['monday', 'tuesday', 'wednesday', 'thursday', 'friday'];\n  \n  // Get preferred days or default to all weekdays\n  const preferredDays = meetingParams.preferredDays && meetingParams.preferredDays.length > 0 \n    ? meetingParams.preferredDays \n    : days;\n  \n  // Create dummy slots\n  return [\n    {\n      day: preferredDays[0] || 'monday',\n      date: 'May 1',\n      time: '10:00 AM - 11:00 AM',\n      availability: 'all'\n    },\n    {\n      day: preferredDays[preferredDays.length > 1 ? 1 : 0] || 'wednesday',\n      date: 'May 3',\n      time: '2:00 PM - 3:00 PM',\n      availability: 'all'\n    },\n    {\n      day: preferredDays[0] || 'monday',\n      date: 'May 8',\n      time: '11:00 AM - 12:00 PM',\n      availability: 'partial',\n      availableCount: 2,\n      totalCount: 3\n    }\n  ];\n};\n\nconst fallbackRecommendations = (moodEntries, activityEntries) => {\n  // Simple recommendations\n  return [\n    {\n      id: 'morning',\n      title: 'Morning Routine',\n      activities: [\n        { time: '07:00 AM', description: 'Wake up & hydrate', category: 'selfCare' },\n        { time: '07:15 AM', description: 'Quick stretch or meditation', category: 'selfCare' },\n        { time: '07:45 AM', description: 'Healthy breakfast', category: 'selfCare' },\n        { time: '08:15 AM', description: 'Plan your day', category: 'work' },\n      ]\n    },\n    {\n      id: 'balance',\n      title: 'Balance Your Day',\n      activities: [\n        { time: '11:30 AM', description: 'Take a short break', category: 'selfCare' },\n        { time: '05:00 PM', description: 'Transition from work to personal time', category: 'selfCare' },\n        { time: '07:00 PM', description: 'Dinner & relaxation', category: 'leisure' },\n        { time: '10:00 PM', description: 'Wind down routine', category: 'sleep' },\n      ]\n    }\n  ];\n};\n\nconst fallbackReflectionAnalysis = (reflectionText) => {\n  return \"Thank you for sharing your reflection. It's great that you're taking time to review your day. Consider how your activities might be affecting your mood, and remember that small adjustments can lead to significant improvements in your well-being. Keep up the good work with your self-reflection practice!\";\n};\n\n// Create a named export object\nconst openAIService = {\n  parseEventText,\n  optimizeTaskSchedule,\n  findBestMeetingSlots,\n  generateRecommendations,\n  analyzeReflection\n};\n\nexport default openAIService;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}